<!DOCTYPE html><html lang="en"><head><meta charset="utf-8"/><meta http-equiv="X-UA-Compatible" content="IE=edge"/><title>Decorators · Draft.js</title><meta name="viewport" content="width=device-width"/><meta name="generator" content="Docusaurus"/><meta property="og:title" content="Decorators · Draft.js"/><meta property="og:type" content="website"/><meta property="og:url" content="https://draftjs.org/index.html"/><meta property="og:description" content="Inline and block styles aren&#x27;t the only kind of rich styling that we might"/><meta name="twitter:card" content="summary"/><link rel="shortcut icon" href="/undefined"/><link rel="stylesheet" href="//cdnjs.cloudflare.com/ajax/libs/highlight.js/9.12.0/styles/atelier-forest-light.min.css"/><script>
              (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
              (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
              m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
              })(window,document,'script','https://www.google-analytics.com/analytics.js','ga');

              ga('create', 'UA-44373548-19', 'auto');
              ga('send', 'pageview');
            </script><script type="text/javascript" src="https://buttons.github.io/buttons.js"></script><link rel="stylesheet" href="/css/main.css"/></head><body class="sideNavVisible doc"><div class="fixedHeaderContainer"><div class="headerWrapper wrapper"><header><a href="/"><h2 class="headerTitle">Draft.js</h2></a><div class="navigationWrapper navigationSlider"><nav class="slidingNav"><ul class="nav-site nav-site-internal"><li class="siteNavGroupActive"><a href="/docs/getting-started.html" target="_self">Docs</a></li><li class=""><a href="https://github.com/facebook/draft-js" target="_self">GitHub</a></li></ul></nav></div></header></div></div><div class="navPusher"><div class="docMainWrapper wrapper"><div class="container docsNavContainer" id="docsNav"><nav class="toc"><div class="toggleNav"><section class="navWrapper wrapper"><div class="navBreadcrumb wrapper"><div class="navToggle" id="navToggler"><i></i></div><h2><i>›</i><span>Advanced Topics</span></h2></div><div class="navGroups"><div class="navGroup navGroupActive"><h3>Quick Start</h3><ul><li class="navListItem"><a class="navItem" href="/docs/getting-started.html">Overview</a></li><li class="navListItem"><a class="navItem" href="/docs/quickstart-api-basics.html">API Basics</a></li><li class="navListItem"><a class="navItem" href="/docs/quickstart-rich-styling.html">Rich Styling</a></li></ul></div><div class="navGroup navGroupActive"><h3>Advanced Topics</h3><ul><li class="navListItem"><a class="navItem" href="/docs/advanced-topics-entities.html">Entities</a></li><li class="navListItem"><a class="navItem" href="/docs/v0-10-api-migration.html">v0.10 API Migration</a></li><li class="navListItem navListItemActive"><a class="navItem navItemActive" href="/docs/advanced-topics-decorators.html">Decorators</a></li><li class="navListItem"><a class="navItem" href="/docs/advanced-topics-key-bindings.html">Key Bindings</a></li><li class="navListItem"><a class="navItem" href="/docs/advanced-topics-managing-focus.html">Managing Focus</a></li><li class="navListItem"><a class="navItem" href="/docs/advanced-topics-block-styling.html">Block Styling</a></li><li class="navListItem"><a class="navItem" href="/docs/advanced-topics-custom-block-render-map.html">Custom Block Rendering</a></li><li class="navListItem"><a class="navItem" href="/docs/advanced-topics-block-components.html">Custom Block Components</a></li><li class="navListItem"><a class="navItem" href="/docs/advanced-topics-inline-styles.html">Complex Inline Styles</a></li><li class="navListItem"><a class="navItem" href="/docs/advanced-topics-nested-lists.html">Nested Lists</a></li><li class="navListItem"><a class="navItem" href="/docs/advanced-topics-text-direction.html">Text Direction</a></li><li class="navListItem"><a class="navItem" href="/docs/advanced-topics-editorstate-race-conditions.html">EditorState Race Conditions</a></li><li class="navListItem"><a class="navItem" href="/docs/advanced-topics-issues-and-pitfalls.html">Issues and Pitfalls</a></li></ul></div><div class="navGroup navGroupActive"><h3>API Reference</h3><ul><li class="navListItem"><a class="navItem" href="/docs/api-reference-editor.html">Editor Component</a></li><li class="navListItem"><a class="navItem" href="/docs/api-reference-editor-change-type.html">EditorChangeType</a></li><li class="navListItem"><a class="navItem" href="/docs/api-reference-editor-state.html">EditorState</a></li><li class="navListItem"><a class="navItem" href="/docs/api-reference-content-state.html">ContentState</a></li><li class="navListItem"><a class="navItem" href="/docs/api-reference-content-block.html">ContentBlock</a></li><li class="navListItem"><a class="navItem" href="/docs/api-reference-character-metadata.html">CharacterMetadata</a></li><li class="navListItem"><a class="navItem" href="/docs/api-reference-entity.html">Entity</a></li><li class="navListItem"><a class="navItem" href="/docs/api-reference-selection-state.html">SelectionState</a></li><li class="navListItem"><a class="navItem" href="/docs/api-reference-composite-decorator.html">CompositeDecorator</a></li><li class="navListItem"><a class="navItem" href="/docs/api-reference-data-conversion.html">Data Conversion</a></li><li class="navListItem"><a class="navItem" href="/docs/api-reference-rich-utils.html">RichUtils</a></li><li class="navListItem"><a class="navItem" href="/docs/api-reference-atomic-block-utils.html">AtomicBlockUtils</a></li><li class="navListItem"><a class="navItem" href="/docs/api-reference-key-binding-util.html">KeyBindingUtil</a></li><li class="navListItem"><a class="navItem" href="/docs/api-reference-modifier.html">Modifier</a></li></ul></div></div></section></div><script>
          var toggler = document.getElementById('navToggler');
          var nav = document.getElementById('docsNav');
          toggler.onclick = function() {
            nav.classList.toggle('docsSliderActive');
          };
        </script></nav></div><div class="container mainContainer"><div class="wrapper"><div class="post"><header class="postHeader"><h1>Decorators</h1></header><article><div><span><p>Inline and block styles aren't the only kind of rich styling that we might
want to add to our editor. The Facebook comment input, for example, provides
blue background highlights for mentions and hashtags.</p>
<p>To support flexibility for custom rich text, Draft provides a &quot;decorator&quot;
system. The <a href="https://github.com/facebook/draft-js/tree/master/examples/draft-0-10-0/tweet">tweet example</a>
offers a live example of decorators in action.</p>
<h2><a class="anchor" aria-hidden="true" id="compositedecorator"></a><a href="#compositedecorator" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>CompositeDecorator</h2>
<p>The decorator concept is based on scanning the contents of a given
<a href="/docs/api-reference-content-block.html">ContentBlock</a>
for ranges of text that match a defined strategy, then rendering them
with a specified React component.</p>
<p>You can use the <code>CompositeDecorator</code> class to define your desired
decorator behavior. This class allows you to supply multiple <code>DraftDecorator</code>
objects, and will search through a block of text with each strategy in turn.</p>
<p>Decorators are stored within the <code>EditorState</code> record. When creating a new
<code>EditorState</code> object, e.g. via <code>EditorState.createEmpty()</code>, a decorator may
optionally be provided.</p>
<blockquote>
<p>Under the hood</p>
<p>When contents change in a Draft editor, the resulting <code>EditorState</code> object
will evaluate the new <code>ContentState</code> with its decorator, and identify ranges
to be decorated. A complete tree of blocks, decorators, and inline styles is
formed at this time, and serves as the basis for our rendered output.</p>
<p>In this way, we always ensure that as contents change, rendered decorations
are in sync with our <code>EditorState</code>.</p>
</blockquote>
<p>In the &quot;Tweet&quot; editor example, for instance, we use a <code>CompositeDecorator</code> that
searches for @-handle strings as well as hashtag strings:</p>
<pre><code class="hljs css js"><span class="hljs-keyword">const</span> compositeDecorator = <span class="hljs-keyword">new</span> CompositeDecorator([
  {
    <span class="hljs-attr">strategy</span>: handleStrategy,
    <span class="hljs-attr">component</span>: HandleSpan,
  },
  {
    <span class="hljs-attr">strategy</span>: hashtagStrategy,
    <span class="hljs-attr">component</span>: HashtagSpan,
  },
]);
</code></pre>
<p>This composite decorator will first scan a given block of text for @-handle
matches, then for hashtag matches.</p>
<pre><code class="hljs css js"><span class="hljs-comment">// Note: these aren't very good regexes, don't use them!</span>
<span class="hljs-keyword">const</span> HANDLE_REGEX = <span class="hljs-regexp">/\@[\w]+/g</span>;
<span class="hljs-keyword">const</span> HASHTAG_REGEX = <span class="hljs-regexp">/\#[\w\u0590-\u05ff]+/g</span>;

<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">handleStrategy</span>(<span class="hljs-params">contentBlock, callback, contentState</span>) </span>{
  findWithRegex(HANDLE_REGEX, contentBlock, callback);
}

<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">hashtagStrategy</span>(<span class="hljs-params">contentBlock, callback, contentState</span>) </span>{
  findWithRegex(HASHTAG_REGEX, contentBlock, callback);
}

<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">findWithRegex</span>(<span class="hljs-params">regex, contentBlock, callback</span>) </span>{
  <span class="hljs-keyword">const</span> text = contentBlock.getText();
  <span class="hljs-keyword">let</span> matchArr, start;
  <span class="hljs-keyword">while</span> ((matchArr = regex.exec(text)) !== <span class="hljs-literal">null</span>) {
    start = matchArr.index;
    callback(start, start + matchArr[<span class="hljs-number">0</span>].length);
  }
}
</code></pre>
<p>The strategy functions execute the provided callback with the <code>start</code> and
<code>end</code> values of the matching range of text.</p>
<h2><a class="anchor" aria-hidden="true" id="decorator-components"></a><a href="#decorator-components" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Decorator Components</h2>
<p>For your decorated ranges of text, you must define a React component to use
to render them. These tend to be simple <code>span</code> elements with CSS classes or
styles applied to them.</p>
<p>In our current example, the <code>CompositeDecorator</code> object names <code>HandleSpan</code> and
<code>HashtagSpan</code> as the components to use for decoration. These are just basic
stateless components:</p>
<pre><code class="hljs css js"><span class="hljs-keyword">const</span> HandleSpan = <span class="hljs-function">(<span class="hljs-params">props</span>) =&gt;</span> {
  <span class="hljs-keyword">return</span> <span class="xml"><span class="hljs-tag">&lt;<span class="hljs-name">span</span> {<span class="hljs-attr">...props</span>} <span class="hljs-attr">style</span>=<span class="hljs-string">{styles.handle}</span>&gt;</span>{props.children}<span class="hljs-tag">&lt;/<span class="hljs-name">span</span>&gt;</span></span>;
};

<span class="hljs-keyword">const</span> HashtagSpan = <span class="hljs-function">(<span class="hljs-params">props</span>) =&gt;</span> {
  <span class="hljs-keyword">return</span> <span class="xml"><span class="hljs-tag">&lt;<span class="hljs-name">span</span> {<span class="hljs-attr">...props</span>} <span class="hljs-attr">style</span>=<span class="hljs-string">{styles.hashtag}</span>&gt;</span>{props.children}<span class="hljs-tag">&lt;/<span class="hljs-name">span</span>&gt;</span></span>;
};
</code></pre>
<p>The Decorator Component will receive various pieces of metadata in <code>props</code>,
including a copy of the <code>contentState</code>, the <code>entityKey</code> if there is one, and the
<code>blockKey</code>. For a full list of props supplied to a Decorator Component see the
<a href="https://github.com/facebook/draft-js/blob/master/src/model/decorators/DraftDecorator.js">DraftDecoratorComponentProps type</a>.</p>
<p>Note that <code>props.children</code> is passed through to the rendered output. This is
done to ensure that the text is rendered within the decorated <code>span</code>.</p>
<p>You can use the same approach for links, as demonstrated in our
<a href="https://github.com/facebook/draft-js/tree/master/examples/draft-0-10-0/link">link example</a>.</p>
<h3><a class="anchor" aria-hidden="true" id="beyond-compositedecorator"></a><a href="#beyond-compositedecorator" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Beyond CompositeDecorator</h3>
<p>The decorator object supplied to an <code>EditorState</code> need only match the expectations
of the
<a href="https://github.com/facebook/draft-js/blob/master/src/model/decorators/DraftDecoratorType.js">DraftDecoratorType</a>
Flow type definition, which means that you can create any decorator classes
you wish, as long as they match the expected type -- you are not bound by
<code>CompositeDecorator</code>.</p>
<h2><a class="anchor" aria-hidden="true" id="setting-new-decorators"></a><a href="#setting-new-decorators" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Setting new decorators</h2>
<p>Further, it is acceptable to set a new <code>decorator</code> value on the <code>EditorState</code>
on the fly, during normal state propagation -- through immutable means, of course.</p>
<p>This means that during your app workflow, if your decorator becomes invalid or
requires a modification, you can create a new decorator object (or use
<code>null</code> to remove all decorations) and <code>EditorState.set()</code> to make use of the new
decorator setting.</p>
<p>For example, if for some reason we wished to disable the creation of @-handle
decorations while the user interacts with the editor, it would be fine to do the
following:</p>
<pre><code class="hljs css js"><span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">turnOffHandleDecorations</span>(<span class="hljs-params">editorState</span>) </span>{
  <span class="hljs-keyword">const</span> onlyHashtags = <span class="hljs-keyword">new</span> CompositeDecorator([{
    <span class="hljs-attr">strategy</span>: hashtagStrategy,
    <span class="hljs-attr">component</span>: HashtagSpan,
  }]);
  <span class="hljs-keyword">return</span> EditorState.set(editorState, {<span class="hljs-attr">decorator</span>: onlyHashtags});
}
</code></pre>
<p>The <code>ContentState</code> for this <code>editorState</code> will be re-evaluated with the new
decorator, and @-handle decorations will no longer be present in the next
render pass.</p>
<p>Again, this remains memory-efficient due to data persistence across immutable
objects.</p>
</span></div></article></div><div class="docs-prevnext"><a class="docs-prev button" href="v0-10-api-migration.html">← v0.10 API Migration</a><a class="docs-next button" href="advanced-topics-key-bindings.html">Key Bindings →</a></div></div></div></div><footer class="nav-footer" id="footer"><section class="sitemap"><div><h5>Docs</h5><a href="/docs/getting-started.html">Getting Started</a><a href="/docs/api-reference-editor.html">API Reference</a></div><div><h5>Community</h5><a href="http://stackoverflow.com/questions/tagged/draftjs" target="_blank">Stack Overflow</a><a href="https://twitter.com/draft_js" target="_blank">Twitter</a></div><div><h5>More</h5><a href="https://github.com/noamelb/draft-js">GitHub</a><a class="github-button" href="https://github.com/noamelb/draft-js" data-icon="octicon-star" data-count-href="/noamelb/draft-js/stargazers" data-show-count="true" data-count-aria-label="# stargazers on GitHub" aria-label="Star this project on GitHub">Star</a></div></section><a href="https://code.facebook.com/projects/" target="_blank" class="fbOpenSource"><img src="/img/oss_logo.png" alt="Facebook Open Source" width="170" height="45"/></a><section class="copyright">Copyright © 2018 Facebook Inc.</section></footer></div></body></html>